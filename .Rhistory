unemployment_df$county <- strsplit(unemployment_df$county, " County") #Remove the word County from the county names
unemployment_df$county <- tolower(unemployment_df$county) #Changed the county names to lowercase
unemployment_df <- unite(unemployment_df, state.fips, county.fips, col ="county.fips", sep="") #Combine two columns to make them into one.
#The states that appeared as NA in this dataframe represented DC, hence the NAs will be changed to DC
unemployment_df <- replace_na(unemployment_df, list(state="DC", unemployment_df$state))
#Converting from character to numeric for merging purposes
unemployment_df$county.fips <- as.numeric(unemployment_df$county.fips)
unemployment_df$year <- as.numeric(unemployment_df$year)
# There is an extra space in front or back of the state names. Need to remove them
unemployment_df <- unemployment_df %>%
mutate(state = str_replace_all(state, " ", "")) %>%
filter(state != "AK" & state != "PR")
#Do the lag of unemloyment
unemployment_df <- unemployment_df %>%
arrange(county.fips, year) %>%
group_by(county.fips) %>%
mutate(unemp_lag = lag(unemp)) %>%
filter(year %% 2 == 1)
#Calculate the one year percent change for unemployment
unemployment_df <- unemployment_df %>%
mutate(unemp_gro = (unemp - unemp_lag) / unemp_lag) %>%
select(county.fips, county, state, year, unemp_gro)
#Renaming certain objects in the county names
unemployment_df <- unemployment_df %>%
mutate(county = str_replace_all(county, " parish", "")) %>%
mutate(county = str_replace_all(county, " city", "")) %>%
mutate(county = str_replace_all(county, " town", ""))
#********************************************Merging all datasets************************************
# Finally merging all the 3 dataframes: bea_df2, election_df, and unemployment_df2
beabls_df <- merge(unemployment_df, bea_df, by= c('county.fips'), all.x = TRUE) #Merging first two datasets
beablselec <- merge(beabls_df, election_df, by =c('county.fips'), all.x = TRUE)
p2_merged_df1 <- beablselec %>%
select(county.fips, county.x, state.x, unemp_gro, pop, pop_thou, pci_gro, pcct_gro,
jobs_gro, av_wage_gro, manu_share_gro, rep.share, repshare.lag, is.rep.2012, is.rep.2016) %>%
rename(county = county.x, state = state.x)
#Rural dummy:
rural <- read.csv("rural.csv")
rural <- rural %>%
rename(county.fips = Ã¯..county.fips) %>%
select(county.fips, rural_percent, rural)
p2_merged_df2 <- merge(p2_merged_df1, rural, by = 'county.fips', all.x = TRUE)
# White dummy 18 years and above white
race <- read.csv("race2015.csv")
race <- race %>%
rename(county.fips = FIPS) %>%
select(county.fips, white)
p2_merged_df3 <- merge(p2_merged_df2, race, by = c('county.fips'), all.x = TRUE)
p2_merged_df3 <- p2_merged_df3 %>%
mutate(white.percent = white / pop)
#Removing duplicate counties. There were 6 of them. #TOTO: this is not working since it is showing a total of 3118 counties instead of 3112.
issue.data <- p2_merged_df3 %>%
group_by(county.fips) %>%
summarise(issue = n())
p2_merged_df3 %<>% merge(issue.data) %>%
mutate(drop = ifelse(issue > 1 & is.na(pop), 1, 0)) %>%
filter(drop == 0) %>%
select(-drop, -issue)
## Load and clean the education data:
edu.data <- rio::import("ACS_15_5YR_B15003_with_ann.csv", skip = 1) %>%
select(-matches("Margin"), -`Estimate; Total:`) %>%
select(matches("school|Kinder|grade|id2")) %>%
dplyr::rename(county.fips = Id2)
colnames(edu.data) <- colnames(edu.data) %>%
stringi::stri_replace_all_fixed("Estimate; Total: - ", "") %>%
stringi::stri_replace_all_fixed(" ", "") %>%
stringi::stri_replace_all_regex(",|'", "")
edu.data %<>%
select(-Professionalschooldegree, -Regularhighschooldiploma, -`12thgradenodiploma`) %>%
mutate(total = rowSums(.) - county.fips) %>%
select(county.fips, total)
p2_merged_df4 <- merge(p2_merged_df3, edu.data)
p2_merged_df4 <- p2_merged_df4 %>%
mutate(uneduc = total / pop)
#Creating the new variable for flip.
p2_merged_df5 <- p2_merged_df4 %>%
mutate(flip = is.rep.2016 - is.rep.2012)
#0 means didn't flip, 1 means flipped to republican and -1 means flipped to democratic.
p2_merged_df5 <- p2_merged_df5 %>%
mutate(rep.share.gro = (rep.share - repshare.lag)/repshare.lag)
#Remove previous dataframes:
rm(election_df1, election_df2)
rm(beaPop, beaPCI, beaPercapita_Current_Transfer, beaManufacturing, beaPrivate, beaEMP, beaWage)
rm(Population, PerCapitaIncome, PerCapitaCurrentTransfer, bea_df, Jobs, Wage, Manufacturing, Private)
rm(unemp12, unemp15, unemployment_df)
rm(beabls_df, beablselec, election_df)
rm(issue.data, race, rural, p2_merged_df1, p2_merged_df2, p2_merged_df3, edu.data, p2_merged_df4)
View(p2_merged_df5)
source("Statistics_Part2.R")
source("Statistics_Part2.R")
m23 <- lm(rep.share.gro ~ manu_share_gro, p2_merged_df5)
summary(m23)
m24 <- lm(rep.share.gro ~ manu_share_gro + jobs_gro + av_wage_gro + pop_thou + uneduc + white.percent + as.factor(rural):white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m25)
summary(m24)
m24 <- lm(rep.share.gro ~ manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent + as.factor(rural):white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m25)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro::pci_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro:pci_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + pci_gro + manu_share + manu_share_gro:pci_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
m24 <- lm(rep.share.gro ~ unemp_gro + pci_gro + manu_share_gro + manu_share_gro:pci_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m24)
p2_merged_df5$rustbelt <- ifelse(state == c("NY", "PA", "WV", "OH", "IN", "MI", "IL", "IA", "WI"), 1, 0)
p2_merged_df5$rustbelt <- ifelse(state = c("NY", "PA", "WV", "OH", "IN", "MI", "IL", "IA", "WI"), 1, 0)
p2_merged_df5$rustbelt <- ifelse(state == "NY" | "PA"| "WV" | "OH" | "IN" | "MI"| "IL"| "IA" | "WI"), 1, 0)
p2_merged_df5$is.rustbelt <- ifelse(state == c("NY","PA","WV","OH", "IN","MI","IL","IA","WI"), "1", "0")
p2_merged_df5$is.rustbelt <- ifelse(state = c("NY","PA","WV","OH", "IN","MI","IL","IA","WI"), "1", "0")
p2_merged_df5_swing <- p2_merged_df5 %>%
filter(state == c("CO", "FL", "IO", "NC", "NH", "OH", "PA", "VA", "NV", "WI"))
View(p2_merged_df5_swing)
p2_merged_df5_swing <- p2_merged_df5 %>%
filter(state == "CO" & "FL" & "IO" & "NC" & "NH" & "OH" & "PA" & "VA" & "NV" & "WI")
View(p2_merged_df5_swing)
p2_merged_df5_swing <- p2_merged_df5 %>%
filter(state == "CO" & state == "FL" & state == "IO"
& state == "NC" & state == "NH" & state == "OH" & state == "PA"
& state == "VA" & state == "NV" & state == "WI")
p2_merged_df5_swing <- p2_merged_df5 %>%
filter(state == "CO" | state == "FL" | state == "IO"
| state == "NC" | state == "NH" | state == "OH" | state == "PA"
| state == "VA" | state == "NV" | state == "WI")
View(p2_merged_df5_swing)
p2_merged_df5_rust <- p2_merged_df5 %>%
filter(state == "NY" | state == "PA" | state == "WV" | state == "OH" | state == "IN"
| state == "MI" | state == "IL" | state == "IA" | state == "WI")
m25 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_swing)
summary(m25)
m26 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_rust)
summary(m26)
m26 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural) + as.factor(rural):white.percent, p2_merged_df5_rust)
summary(m26)
m26 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_rust)
summary(m26)
p2_merged_df5_swing <- p2_merged_df5 %>%
filter(state == "CO" | state == "FL" | state == "IA"
| state == "NC" | state == "NH" | state == "OH" | state == "PA"
| state == "VA" | state == "NV" | state == "WI" | state == "NY" | state == "WV" | state == "IN"
| state == "MI" | state == "IL")
m25 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_swing)
summary(m25)
m25 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + manu_share_gro:white.percent + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_swing)
summary(m25)
p2_merged_df5_swing <- p2_merged_df5 %>%
filter(state == "CO" | state == "FL" | state == "IA"
| state == "NC" | state == "NH" | state == "OH" | state == "PA"
| state == "VA" | state == "NV" | state == "WI")
m25 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_swing)
summary(m25)
m26 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5_rust)
summary(m26)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ as.factor(rural), p2_merged_df5)
summary(m24)
View(p2_merged_df5_swing)
View(p2_merged_df5)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df5)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ rural_percent + uneduc:rural_percent, p2_merged_df5)
summary(m24)
m24 <- lm(rep.share ~ repshare.lag + unemp_gro + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df5)
summary(m24)
m24 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df5)
summary(m24)
View(emp.data)
emp.data <- rio::import("ACS_15_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(matches("MALE"))
View(emp.data)
emp.data <- rio::import("ACS_15_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY"))
View(emp.data)
emp.data <- rio::import("ACS_15_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(-matches("Employment"))
View(emp.data)
emp.data <- rio::import("ACS_15_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(-matches("Employment")) %>%
select(-matches("RACE")) %>%
select(-matches("EDUCATIONAL")) %>%
select(-matches("POVERTY"))
View(emp.data)
names(emp.data)
emp.data <- rio::import("ACS_15_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(-matches("Employment")) %>%
select(-matches("RACE")) %>%
select(-matches("EDUCATIONAL")) %>%
select(-matches("POVERTY")) %>%
select(-Id, -Geography)
View(emp.data)
names(emp.data)
names(emp.data)[names(emp.data)=="Labor Force Participation Rate; Estimate; White alone, not Hispanic or Latino"] <- "lfpr_white"
names(emp.data)[names(emp.data)=="Labor Force Participation Rate; Estimate; Population 20 to 64 years - SEX - Male"] <- "lfpr_male"
names(emp.data)[names(emp.data)=="Id2"] <- "county.fips"
names(emp.data)[names(emp.data)=="Labor Force Participation Rate; Estimate; White alone, not Hispanic or Latino"] <- "lfpr_white_2015"
names(emp.data)[names(emp.data)=="Labor Force Participation Rate; Estimate; Population 20 to 64 years - SEX - Male"] <- "lfpr_male_2015"
emp.data <- emp.data %>%
select(county.fips, lfpr_male_2015, lfpr_white_2015)
emp.data <- rio::import("ACS_15_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(-matches("Employment")) %>%
select(-matches("RACE")) %>%
select(-matches("EDUCATIONAL")) %>%
select(-matches("POVERTY")) %>%
select(-Id, -Geography)
names(emp.data)[names(emp.data)=="Labor Force Participation Rate; Estimate; White alone, not Hispanic or Latino"] <- "lfpr_white_2015"
names(emp.data)[names(emp.data)=="Labor Force Participation Rate; Estimate; Population 20 to 64 years - SEX - Male"] <- "lfpr_male_2015"
names(emp.data)[names(emp.data)=="Id2"] <- "county.fips"
emp.data <- emp.data %>%
select(county.fips, lfpr_male_2015, lfpr_white_2015)
emp.data2012 <- rio::import("ACS_12_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(-matches("Employment")) %>%
select(-matches("RACE")) %>%
select(-matches("EDUCATIONAL")) %>%
select(-matches("POVERTY")) %>%
select(-Id, -Geography)
View(emp.data2012)
emp.data2012 <- rio::import("ACS_12_5YR_S2301_with_ann.csv", skip = 1) %>%
select(-matches("Margin")) %>%
select(-matches("Total")) %>%
select(-matches("Unemployment")) %>%
select(-matches("Female")) %>%
select(-matches("AGE")) %>%
select(-matches("DISABILITY")) %>%
select(-matches("Employment")) %>%
select(-matches("RACE")) %>%
select(-matches("EDUCATIONAL")) %>%
select(-matches("POVERTY")) %>%
select(-matches("Employed")) %>%
select(-Id, -Geography)
View(emp.data2012)
names(emp.data2012)
names(emp.data2012)[names(emp.data2012)=="In labor force; Estimate; White alone, not Hispanic or Latino"] <- "lfpr_white_2012"
names(emp.data2012)[names(emp.data2012)=="In labor force; Estimate; SEX - Male"] <- "lfpr_male_2012"
names(emp.data2012)[names(emp.data2012)=="Id2"] <- "county.fips"
emp.data2012 <- emp.data2012 %>%
select(county.fips, lfpr_male_2012, lfpr_white_2012)
emp.df <- merge(emp.data, emp.data2012)
p2_merged_df6 <- merge(p2_merged_df5, emp.df, all.x = TRUE)
View(p2_merged_df6)
p2_merged_df6 <- p2_merged_df6 %>%
mutate(lfpr_male_gro = lfpr_male_2015 - lfpr_male_2012) %>%
mutate(lfpr_white_gro = lfpr_white_2015 - lfpr_white_2012)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df5)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + lfpr_male_gro:lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m24 <- lm(rep.share.gro ~ unemp_gro + manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m24 <- lm(rep.share.gro ~ manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
p2_merged_df6_swing <- p2_merged_df6 %>%
filter(state == "CO" | state == "FL" | state == "IA"
| state == "NC" | state == "NH" | state == "OH" | state == "PA"
| state == "VA" | state == "NV" | state == "WI")
p2_merged_df6_rust <- p2_merged_df6 %>%
filter(state == "NY" | state == "PA" | state == "WV" | state == "OH" | state == "IN"
| state == "MI" | state == "IL" | state == "IA" | state == "WI")
m24 <- lm(rep.share.gro ~ manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m24 <- lm(rep.share.gro ~ manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m25 <- lm(rep.share.gro ~ manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_swing)
summary(m25)
m26 <- lm(rep.share.gro ~ manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_rust)
summary(m26)
View(p2_merged_df6_swing)
m24 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m25 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + lfpr_white_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_swing)
summary(m25)
m24 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m25 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_swing)
summary(m25)
m26 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_rust)
summary(m26)
m24 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6)
summary(m24)
m25 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_swing)
summary(m25)
m26 <- lm(rep.share ~ repshare.lag + manu_share_gro + av_wage_gro + lfpr_male_gro + pop_thou + uneduc + white.percent +
+ rural_percent, p2_merged_df6_rust)
summary(m26)
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, merged_df4, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + Pop + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), merged_df4, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
source("Statistics.R")
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, merged_df4, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + Pop + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), merged_df4, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
merged_df4 <- merged_df4 %>%
mutate(Pop_thou = Pop / 1000)
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, merged_df4, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + Pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), merged_df4, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
merged_df4 <- merged_df4 %>%
mutate(Pop_thou = Pop / 10000)
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, merged_df4, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + Pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), merged_df4, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
merged_df4 <- merged_df4 %>%
mutate(Pop_thou = Pop / 1000)
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, merged_df4, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + Pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), merged_df4, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
forecast <- predict(f2)
forecast
library(haven)
library(plyr)
library(dplyr)
library(magrittr)
library(broom)
setwd("C:/RajuPC/Desktop")
getwd()
library(haven)
library(plyr)
library(dplyr)
library(magrittr)
library(broom)
gn.model <- function(part = 0, kan = 0, amt = 0, model = "2005") {
if (model=="2005") {
stim <-  -5.93 + 0.75*part + 0.38*kan - 1.52*amt } # formula from Gschwend/Norpoth 2005
else stim <-  -5.6  + 0.75*part + 0.38*kan - 1.5*amt    # formula from Norpoth/Gschwend 2010
return(stim)
}
gn.model()
gn.model(part = 45, kan = 60, amt = 3)
ger_df <- read_dta("data/ger_nat.dta")
ger_df <- read_dta("ger_nat.dta")
View(ger_df)
names(ger_df)
head(ger_df)
model_out <- lm(gov_share ~ gov_share_l3 + chancellor_polls + term, data = ger_df)
summary(model_out)
augment(model_out, newdata = filter(ger_df, year == 2013))
predict(model_out, filter(ger_df, year == 2013), se.fit = TRUE, interval = "confidence")
predict(model_out, filter(ger_df, year == 2013), se.fit = TRUE, interval = "prediction")
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, merged_df4, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + Pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), merged_df4, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
coeftest(f2, vcovHC(f2, method = "arellano"))
packages <- c("bea.R", "acs", "magrittr", "httr", "tidyr", "blsAPI", "rjson", "readxl", "dplyr", "jsonlite",
"stringr", "rJava", "xlsx", "qdap", "data.table", "plm", "rio", "Zelig", "stargazer", "knitr", "lmtest")
load <- lapply(packages, require, character.only = T)
coeftest(f2, vcovHC(f2, method = "arellano"))
test1 <- coeftest(f2, vcovHC(f2, method = "arellano"))
summary(test1)
stargazer::stargazer(test1, type = 'text', digits = 2, header = FALSE,
title = 'Model with Arellano', font.size = 'normalsize', out = 'fixed_part1_arellano.htm')
View(ger_df)
View(merged_df4)
part1_df <- merged_df4 %>%
mutate(pci_gro_sq = PCI_gro^2)
select(county.fips, year, county, state, rep.share, repshare.lag, unemp_gro,
PCI_gro, pci_gro_sq, Pop_thou, white.percent, rep_incumb, rural_percent) %>%
rename(pop_thou = Pop_thou, pci_gro = PCI_gro)
packages <- c("bea.R", "acs", "magrittr", "httr", "tidyr", "blsAPI", "rjson", "readxl", "dplyr", "jsonlite",
"stringr", "rJava", "xlsx", "qdap", "data.table", "plm", "rio", "Zelig", "stargazer", "knitr", "lmtest")
load <- lapply(packages, require, character.only = T)
#Setting the working directory
setwd("C:/RajuPC/MPP Final Thesis/WorkingDirectory")
#All the keys for different APIs obtained from the respective websites
blskey <- "a9e62413e38741b5aeb814efc5a3d066"
beaKey <- 'C3812F4D-F498-40F8-9F36-9FF5AF65DBD7'
censusKey <- "c7ed765d1b03f4217ccc4b37d31b0dc3580db44e"
datagovkey <- "ubFrNGonfwMQm3lK04C6djaMcqFuIe5mvev4RooI"
source("Statistics.R")
part1_df <- merged_df4 %>%
mutate(pci_gro_sq = PCI_gro^2) %>%
select(county.fips, year, county, state, rep.share, repshare.lag, unemp_gro,
PCI_gro, pci_gro_sq, Pop_thou, white.percent, rep_incumb, rural_percent) %>%
rename(pop_thou = Pop_thou, pci_gro = PCI_gro)
source("Statistics_Part2.R")
View(p2_merged_df6)
View(p2_merged_df6)
part2_df <- p2_merged_df6 %>%
mutate(year = as.numeric("2016")) %>%
mutate(rep_incumb = as.numeric("0")) %>%
mutate(pci_gro_sq = pci_gro^2) %>%
select(county.fips, year, county, state, rep.share, repshare.lag, unemp_gro,
pci_gro, pci_gro_sq, pop_thou, white.percent, rep_incumb, rural_percent)
View(part1_df)
View(part2_df)
part2_df <- p2_merged_df6 %>%
mutate(year = "2016") %>%
mutate(rep_incumb = "0") %>%
mutate(pci_gro_sq = pci_gro^2) %>%
select(county.fips, year, county, state, rep.share, repshare.lag, unemp_gro,
pci_gro, pci_gro_sq, pop_thou, white.percent, rep_incumb, rural_percent)
part2_df$year <- as.numeric(part2_df$year)
part2_df$rep_incumb <- as.numeric(part2_df$rep_incumb)
View(part2_df)
forecast_df <- bind_rows(part1_df, part2_df)
View(forecast_df)
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, part1_df, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural)
+ white.percent:as.factor(rural), part1_df, model = 'within')
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, part1_df, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural.percent)
+ white.percent:as.factor(rural), part1_df, model = 'within')
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, part1_df, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural_percent)
+ white.percent:as.factor(rural), part1_df, model = 'within')
f1 <- plm(rep.share ~ unemp_gro + repshare.lag, part1_df, model = 'within')
f2 <- plm(rep.share ~ unemp_gro + repshare.lag + pop_thou + white.percent + as.factor(rep_incumb)
+ unemp_gro:as.factor(rep_incumb) + as.factor(rural_percent)
+ white.percent:as.factor(rural_percent), part1_df, model = 'within')
stargazer::stargazer(f1, f2, type = 'text', digits = 2, header = FALSE,
title = 'Model with Unemployment (OLS)', font.size = 'normalsize', out = 'fixed_part1.htm')
summary(f2)
